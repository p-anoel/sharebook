{"ast":null,"code":"import React from'react';import{useParams,useNavigate}from'react-router-dom';import\"./AddBook.scss\";import{useState,useEffect}from'react';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function AddBook(){let{bookId}=useParams();const[bookData,setBookData]=useState({title:'',categoryId:''});const[categoriesData,setCategoriesData]=useState([]);const history=useNavigate();useEffect(()=>{axios.get('/categories').then(response=>{setCategoriesData(response.data);setBookData({title:'',categoryId:response.data[0].id});}).then(()=>{if(bookId){axios.get(\"/books/\".concat(bookId)).then(response=>{setBookData({title:response.data.title,categoryId:response.data.category.id});});}});},[bookId]);const handleChange=event=>{let currentState={...bookData};currentState[event.target.name]=event.target.value;setBookData(currentState);};const onSubmit=event=>{if(bookId){event.preventDefault();axios.put(\"/books/\".concat(bookId),{...bookData}).then(()=>{//rediriger vers myBooks\nhistory(\"/myBooks\");});}else{event.preventDefault();axios.post('/books',{...bookData}).then(()=>{//rediriger vers myBooks\nhistory(\"/myBooks\");});}};return/*#__PURE__*/_jsxs(\"div\",{className:\"container-add-book\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Ajouter un livre\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Nom du livre\"}),/*#__PURE__*/_jsx(\"input\",{name:\"title\",type:\"text\",value:bookData.title,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Cat\\xE9gorie du livre\"}),/*#__PURE__*/_jsx(\"select\",{name:\"categoryId\",value:bookData.categoryId,onChange:handleChange,className:\"form-select\",children:categoriesData.map(category=>/*#__PURE__*/_jsx(\"option\",{value:category.id,children:category.label},category.id))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"container-submit\",children:/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Valider\",className:\"btn btn-primary\"})})]})]});}","map":{"version":3,"names":["React","useParams","useNavigate","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","AddBook","bookId","bookData","setBookData","title","categoryId","categoriesData","setCategoriesData","history","get","then","response","data","id","concat","category","handleChange","event","currentState","target","name","value","onSubmit","preventDefault","put","post","className","children","type","onChange","map","label"],"sources":["/Users/pnoel/workspace/sharebook/book-api/frontend-sharebook/src/AddBook.js"],"sourcesContent":["import React from 'react'\nimport { useParams, useNavigate } from 'react-router-dom'\nimport \"./AddBook.scss\"\nimport { useState, useEffect } from 'react'\nimport axios from 'axios';\n\nexport default function AddBook() {\n    let { bookId } = useParams();\n    const [bookData, setBookData] = useState({\n        title: '',\n        categoryId: ''\n\n    })\n    const [categoriesData, setCategoriesData] = useState([])\n    const history = useNavigate();\n\n    useEffect(() => {\n        axios.get('/categories').then(response => {\n            setCategoriesData(response.data)\n            setBookData({\n                title: '',\n                categoryId: response.data[0].id\n            })\n        }).then(() => {\n            if (bookId) {\n                axios.get(`/books/${bookId}`).then(response => {\n                    setBookData({\n                        title: response.data.title,\n                        categoryId: response.data.category.id\n                    })})\n                }\n\n            })\n    }, [bookId]);\n\n    const handleChange = (event) => {\n        let currentState = {...bookData};\n        currentState[event.target.name] = event.target.value;\n        setBookData(currentState)\n    }\n\n    const onSubmit = (event) => {\n        if (bookId) {\n            event.preventDefault();\n            axios.put(`/books/${bookId}`, {\n                ...bookData\n            }).then(() => {\n                //rediriger vers myBooks\n                history(\"/myBooks\")\n            })\n        } else {\n            event.preventDefault();\n            axios.post('/books', {\n                ...bookData\n            }).then(() => {\n                //rediriger vers myBooks\n                history(\"/myBooks\")\n            })\n        }\n    }\n    return (\n        <div className=\"container-add-book\">\n            <h1>Ajouter un livre</h1>\n            <form onSubmit={onSubmit}>\n                <div>\n                    <label>Nom du livre</label>\n                    <input name=\"title\" type=\"text\" value={bookData.title} onChange={handleChange} className=\"form-control\"></input>\n                </div>\n                <div>\n                    <label>Cat√©gorie du livre</label>\n                    <select name=\"categoryId\" value={bookData.categoryId} onChange={handleChange} className=\"form-select\">\n                        {categoriesData.map(category => (\n                            <option value={category.id} key={category.id}>{category.label}</option>\n                        ))}\n                    </select>\n                </div>\n                <div className=\"container-submit\">\n                    <input type=\"submit\" value=\"Valider\" className=\"btn btn-primary\"></input>\n                </div>\n            </form>\n        </div>\n    )\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}