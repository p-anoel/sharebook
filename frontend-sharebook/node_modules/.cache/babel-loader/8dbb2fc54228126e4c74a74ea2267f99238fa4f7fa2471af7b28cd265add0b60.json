{"ast":null,"code":"import React from\"react\";import axios from'axios';import{Link,useNavigate}from\"react-router-dom\";import logo from\"./logo.jpg\";import'./Login.scss';import{AUTH_TOKEN_KEY}from'./App';import SimpleModal from'./SimpleModal';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";class Login extends React.Component{constructor(){super();this.state={userData:{},showModal:false};this.handleChange=this.handleChange.bind(this);this.onSubmit=this.onSubmit.bind(this);this.handleCloseModal=this.handleCloseModal.bind(this);}handleChange(event){let currentState={...this.state.userData};currentState[event.target.name]=event.target.value;this.setState({userData:currentState});}onSubmit(event){event.preventDefault();axios.post('/authenticate',{email:this.state.userData.email,password:this.state.userData.password}).then(response=>{var _response$headers;const bearerToken=response===null||response===void 0?void 0:(_response$headers=response.headers)===null||_response$headers===void 0?void 0:_response$headers.authorization;if(bearerToken&&bearerToken.slice(0,7)==='Bearer '){const jwt=bearerToken.slice(7,bearerToken.length);sessionStorage.setItem(AUTH_TOKEN_KEY,jwt);}this.props.setUserInfo(response.data.userName);this.props.history('/listbooks');}).catch(()=>{this.setState({showModal:true});});}handleCloseModal(){this.setState({showModal:false});}render(){const title=\"Login incorrect\";const bodyTxt=\"Login ou mot de passe incorrect\";return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"login-container\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"img\",{src:logo,alt:\"Logo\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"title\",children:\"Bienvenue sur Sharebook !\"}),/*#__PURE__*/_jsx(\"div\",{className:\"form-container\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:this.onSubmit,children:[/*#__PURE__*/_jsx(\"span\",{children:\"Mail: \"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",name:\"email\",onChange:this.handleChange}),/*#__PURE__*/_jsx(\"span\",{children:\"Password: \"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",name:\"password\",onChange:this.handleChange}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center\",children:/*#__PURE__*/_jsx(\"input\",{type:\"submit\",className:\"btn btn-primary\",value:\"OK\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center\",children:/*#__PURE__*/_jsx(Link,{to:\"/addUser\",children:\"M'inscrire\"})})]})}),/*#__PURE__*/_jsx(SimpleModal,{title:title,bodyTxt:bodyTxt,handleCloseModal:this.handleCloseModal,showModal:this.state.showModal})]});}}export default function(props){const history=useNavigate();return/*#__PURE__*/_jsx(Login,{...props,history:history});}","map":{"version":3,"names":["React","axios","Link","useNavigate","logo","AUTH_TOKEN_KEY","SimpleModal","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Login","Component","constructor","state","userData","showModal","handleChange","bind","onSubmit","handleCloseModal","event","currentState","target","name","value","setState","preventDefault","post","email","password","then","response","_response$headers","bearerToken","headers","authorization","slice","jwt","length","sessionStorage","setItem","props","setUserInfo","data","userName","history","catch","render","title","bodyTxt","children","className","src","alt","type","onChange","to"],"sources":["/Users/pnoel/workspace/sharebook/book-api/frontend-sharebook/src/Login.js"],"sourcesContent":["import React from \"react\";\nimport axios from 'axios';\nimport { Link, useNavigate } from \"react-router-dom\";\nimport logo from \"./logo.jpg\";\nimport './Login.scss';\nimport { AUTH_TOKEN_KEY } from './App'\nimport SimpleModal from './SimpleModal';\n\nclass Login extends React.Component {\n    constructor(){\n        super();\n        this.state = { userData: {}, showModal: false }\n        this.handleChange = this.handleChange.bind(this)\n        this.onSubmit = this.onSubmit.bind(this)\n        this.handleCloseModal = this.handleCloseModal.bind(this)\n    }\n\n    handleChange(event) {\n        let currentState = {...this.state.userData};\n        currentState[event.target.name] = event.target.value;\n        this.setState({ userData: currentState })\n    }\n\n    onSubmit(event) {\n        event.preventDefault();\n        axios.post('/authenticate', {\n            email: this.state.userData.email,\n            password: this.state.userData.password\n        }).then((response) => {\n            const bearerToken = response?.headers?.authorization;\n            if (bearerToken && bearerToken.slice(0, 7) === 'Bearer ') {\n              const jwt = bearerToken.slice(7, bearerToken.length);\n              sessionStorage.setItem(AUTH_TOKEN_KEY,jwt)\n            }\n            this.props.setUserInfo(response.data.userName)\n            this.props.history('/listbooks')\n        }).catch(() => {\n            this.setState({ showModal: true })\n        })\n    }\n\n    handleCloseModal() {\n        this.setState({ showModal: false })\n    }\n\n    render(){\n        const title = \"Login incorrect\"\n        const bodyTxt = \"Login ou mot de passe incorrect\"\n        return (\n            <>\n                <div className=\"login-container\">\n                    <div>\n                        <div>\n                            <img src={logo} alt=\"Logo\" />\n                        </div>\n                        <div className=\"title\">\n                            Bienvenue sur Sharebook !\n                        </div>\n                        <div className=\"form-container\">\n                            <form onSubmit={this.onSubmit}>\n                                <span>Mail: </span>\n                                <input type=\"text\" className=\"form-control\" name=\"email\" onChange={this.handleChange}></input>\n                                <span>Password: </span>\n                                <input type=\"password\" className=\"form-control\" name=\"password\" onChange={this.handleChange}></input>\n                                <div className=\"text-center\">\n                                    <input type=\"submit\" className=\"btn btn-primary\" value=\"OK\"/>\n                                </div>\n                            </form>\n                        </div>\n                        <div className=\"text-center\"><Link to=\"/addUser\">M'inscrire</Link></div>\n                    </div>\n                </div>\n                <SimpleModal title={title} bodyTxt={bodyTxt} handleCloseModal={this.handleCloseModal} showModal={this.state.showModal} />\n            </>\n        )\n    }\n}\n\nexport default function (props) {\n    const history = useNavigate();\n    return <Login {...props} history={history} />;\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}