{"ast":null,"code":"import React from'react';import{Link,useNavigate}from\"react-router-dom\";import'./AddUser.scss';import axios from'axios';import{AUTH_TOKEN_KEY}from'./App';import SimpleModal from'./SimpleModal';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";class AddUser extends React.Component{constructor(){super();this.handleChange=event=>{let currentState={...this.state.userData};currentState[event.target.name]=event.target.value;this.setState({userData:currentState});};this.handleCloseModal=()=>{this.setState({showModal:false});};this.onSubmit=event=>{event.preventDefault();axios.post('/users',{...this.state.userData}).then(response=>{var _response$headers;const bearerToken=response===null||response===void 0?void 0:(_response$headers=response.headers)===null||_response$headers===void 0?void 0:_response$headers.authorization;if(bearerToken&&bearerToken.slice(0,7)==='Bearer '){const jwt=bearerToken.slice(7,bearerToken.length);sessionStorage.setItem(AUTH_TOKEN_KEY,jwt);}this.props.setUserInfo(response.data.firstName+\" \"+response.data.lastName);this.props.history(\"/myBooks\");}).catch(()=>{this.setState({showModal:true});});};this.state={userData:{},showModal:false};}render(){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"add-user-container\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"M'inscrire\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:this.onSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"email\"}),/*#__PURE__*/_jsx(\"input\",{name:\"email\",type:\"text\",className:\"form-control\",onChange:this.handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"nom\"}),/*#__PURE__*/_jsx(\"input\",{name:\"lastName\",type:\"text\",className:\"form-control\",onChange:this.handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"prenom\"}),/*#__PURE__*/_jsx(\"input\",{name:\"firstName\",type:\"text\",className:\"form-control\",onChange:this.handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"password\"}),/*#__PURE__*/_jsx(\"input\",{name:\"password\",type:\"password\",className:\"form-control\",onChange:this.handleChange})]}),/*#__PURE__*/_jsx(\"div\",{className:\"container-valid text-center\",children:/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Valider\",className:\"btn btn-primary\",onChange:this.handleChange})})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"Retour \\xE0 l'accueil\"})})]})}),/*#__PURE__*/_jsx(SimpleModal,{title:\"Mail déja utilisé\",bodyTxt:\"Cet email est déja utilisé, merci d'en saisir un autre\",handleCloseModal:this.handleCloseModal,showModal:this.state.showModal})]});}}export default function(props){const history=useNavigate();return/*#__PURE__*/_jsx(AddUser,{...props,history:history});}","map":{"version":3,"names":["React","Link","useNavigate","axios","AUTH_TOKEN_KEY","SimpleModal","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AddUser","Component","constructor","handleChange","event","currentState","state","userData","target","name","value","setState","handleCloseModal","showModal","onSubmit","preventDefault","post","then","response","_response$headers","bearerToken","headers","authorization","slice","jwt","length","sessionStorage","setItem","props","setUserInfo","data","firstName","lastName","history","catch","render","children","className","type","onChange","to","title","bodyTxt"],"sources":["/Users/pnoel/workspace/sharebook/book-api/frontend-sharebook/src/AddUser.js"],"sourcesContent":["import React from 'react'\nimport { Link , useNavigate } from \"react-router-dom\";\nimport './AddUser.scss'\nimport axios from 'axios';\nimport { AUTH_TOKEN_KEY } from './App';\nimport SimpleModal from './SimpleModal';\n\nclass AddUser extends React.Component {\n\n  constructor() {\n    super();\n    this.state = { userData: {}, showModal: false}\n  }\n\n  handleChange = (event) => {\n    let currentState = { ...this.state.userData };\n    currentState[event.target.name] = event.target.value;\n    this.setState({ userData: currentState })\n  }\n\n  handleCloseModal = () => {\n    this.setState({ showModal: false })\n  }\n\n  onSubmit = (event) => {\n    event.preventDefault();\n    axios.post('/users', {\n        ...this.state.userData\n      }).then(response => {\n         const bearerToken = response?.headers?.authorization;\n         if (bearerToken && bearerToken.slice(0, 7) === 'Bearer ') {\n           const jwt = bearerToken.slice(7, bearerToken.length);\n           sessionStorage.setItem(AUTH_TOKEN_KEY,jwt)\n         }\n         this.props.setUserInfo(response.data.firstName + \" \" + response.data.lastName)\n       this.props.history(\"/myBooks\")\n     }).catch(() => {\n       this.setState({ showModal: true })\n     })\n   }\n\n  render() {\n    return (\n      <>\n      <div className=\"add-user-container\">\n        <div>\n          <h1>M'inscrire</h1>\n          <div>\n            <form onSubmit={this.onSubmit}>\n              <div>\n                <label>email</label>\n                <input name=\"email\" type=\"text\" className=\"form-control\" onChange={this.handleChange} />\n              </div>\n              <div>\n                <label>nom</label>\n                <input name=\"lastName\" type=\"text\" className=\"form-control\" onChange={this.handleChange} />\n              </div>\n              <div>\n                <label>prenom</label>\n                <input name=\"firstName\" type=\"text\" className=\"form-control\" onChange={this.handleChange} />\n              </div>\n              <div>\n                <label>password</label>\n                <input name=\"password\" type=\"password\" className=\"form-control\" onChange={this.handleChange} />\n              </div>\n              <div className=\"container-valid text-center\">\n                <input type=\"submit\" value=\"Valider\" className=\"btn btn-primary\" onChange={this.handleChange} />\n              </div>\n            </form>\n          </div>\n          <div><Link to=\"/\">Retour à l'accueil</Link></div>\n        </div>\n      </div>\n        <SimpleModal\n        title={\"Mail déja utilisé\"}\n        bodyTxt={\"Cet email est déja utilisé, merci d'en saisir un autre\"}\n        handleCloseModal={this.handleCloseModal}\n        showModal={this.state.showModal}\n        ></SimpleModal>\n      </>\n    )\n  }\n}\n\nexport default function (props) {\n    const history = useNavigate();\n    return <AddUser {...props} history={history} />;\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}